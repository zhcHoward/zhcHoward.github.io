---
layout: post
title: Linux 学习笔记
tags:
- Linux
- CentOS
- network manage
---

CentOS建站坑：

1. CentOS7使用firewalld，默认在public zone下，只允许dhcp和ssh服务，所以需要手动开启http和https的服务。
```bash
firewall-cmd --add-service=http
firewall-cmd --add-service=https
```
[详细教程](https://www.digitalocean.com/community/tutorials/how-to-set-up-a-firewall-using-firewalld-on-centos-7)

2. 在配置好一切（uwsgi，nginx，django...）之后，每次当我尝试访问我的主页时，nginx的error.log都会显示`connect() to unix:/var/mysite/mysite.socket failed (13: Permission denied)`，我尝试了很多方法，甚至把socket文件的权限改为了777，还是不行。最后，终于发现是SELinux的问题。
   查看是不是SELinux的问题：
   ```sudo cat /var/log/audit/audit.log | grep nginx | grep denied```
   如果你看见多条**denied**的信息，就很有可能是SELinux的问题。
   查看SELinux对于http_d的设置：
   ```getsebool -a | grep httpd```
   返回的结果中有一行`httpd_can_network_connect`，如果被设置成off的话，需要把它打开：
   ```setsebool httpd_can_network_connect on -P```
   `-P`是为了使改动永久生效。
   [链接](http://stackoverflow.com/questions/23948527/13-permission-denied-while-connecting-to-upstreamnginx)